/* Blossom & Blade — chat.css (2-col layout, glass behind, bubbles on top) */

:root{
  --bg: #0b0c10;
  --ink: #e6e6f0;
  --muted: #a9a9b5;
  --me: #ff2e7e;
  --them: #121318;
  --glass: rgba(8,10,14,.40);
  --radius: 18px;
  --shadow: 0 12px 30px rgba(0,0,0,.45);
}

*{ box-sizing:border-box }
html,body{ height:100%; background:var(--bg); color:var(--ink); font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif; }
a{ color:#95b8ff; text-decoration:none }

header.bar{
  position:sticky; top:0; z-index:50;
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; padding:10px 14px;
  background:linear-gradient(180deg, rgba(10,10,12,.85), rgba(10,10,12,.55));
  backdrop-filter: blur(8px);
  border-bottom:1px solid rgba(255,255,255,.06);
}
.bar .left, .bar .right{ display:flex; align-items:center; gap:12px }
.bar .home{ font-weight:700 }
.bar .man{ font-weight:700 }
.badge{ padding:3px 8px; border-radius:999px; font-size:12px; border:1px solid rgba(255,255,255,.18); opacity:.9 }
.plan{ background:#1b1d23 }
.red{ color:#ff6b6b; border-color:rgba(255,107,107,.4); }

/* Full-screen persona background sits BEHIND everything */
#bg{
  position:fixed; inset:0; z-index:1;
  background-size:cover; background-position:center;
  filter:contrast(1.02) saturate(1.05) brightness(.95);
}
#bg::after{ /* darken for readability */
  content:""; position:absolute; inset:0;
  background:radial-gradient(ellipse at 60% 50%, rgba(0,0,0,.25) 0%, rgba(0,0,0,.70) 70%);
}

/* Stage grid */
.stage{
  position:relative; z-index:2;   /* above bg */
  display:grid; grid-template-columns: 420px minmax(0,1fr);
  gap:22px; padding:16px 18px 26px;
  max-width:1300px; margin:0 auto;
}

/* Left portrait panel */
.portraitPanel{
  position:relative; border-radius:20px; overflow:hidden;
  background:rgba(12,14,18,.6); box-shadow:var(--shadow);
  min-height:560px;
}
.portraitPanel img{
  width:100%; height:100%; object-fit:cover; display:block;
  transform:translateZ(0);  /* crisp */
}

/* Right chat panel */
.chatPanel{
  position:relative; display:flex; flex-direction:column; gap:14px;
  min-height:560px;
}
.chatGlass{     /* “glass” is BEHIND bubbles */
  position:absolute; inset:0; border-radius:20px; z-index:2;
  background:var(--glass); backdrop-filter: blur(8px) saturate(1.1);
  box-shadow:var(--shadow);
}
.messages{
  position:relative; z-index:3;  /* bubbles ABOVE glass */
  padding:20px; overflow:auto; height:calc(100svh - 210px);
  display:flex; flex-direction:column; gap:14px;
  scroll-behavior:smooth;
}

/* Bubbles */
.bubble{
  max-width:min(780px, 80%);
  padding:14px 16px; border-radius:16px;
  background:var(--them); color:var(--ink);
  box-shadow: 0 6px 18px rgba(0,0,0,.35);
  line-height:1.35; letter-spacing:.1px;
}
.bubble small.nick{ display:block; opacity:.65; margin-bottom:6px }
.bubble.me{
  align-self:flex-end; background:var(--me); color:#020204;
}
.bubble.typing{ opacity:.85; }

/* Composer */
.composer{
  position:relative; z-index:3; display:flex; gap:10px;
  padding:6px; border-radius:16px; background:rgba(12,14,18,.65); box-shadow:var(--shadow);
}
#input{
  flex:1; padding:14px 14px; border-radius:12px; background:#0e1015; color:var(--ink);
  border:1px solid rgba(255,255,255,.08); outline:none;
}
#sendBtn{
  padding:12px 18px; border-radius:12px; border:0; cursor:pointer;
  font-weight:700; background:var(--me); color:#08080c;
}
.hidden { display: none !important; }

/* Mobile */
@media (max-width: 980px){
  .stage{ grid-template-columns: 1fr; gap:14px; padding:12px }
  .portraitPanel{ height:48svh; min-height:360px }
  .messages{ height:calc(100svh - 320px) }
}
