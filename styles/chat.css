/* Blossom N Blade â€” chat.css (wallpaper & layout hardening)
   - Full-bleed wallpaper behind everything
   - Desktop: wall fixed; Mobile: no fixed (iOS perf)
   - Only #feed scrolls; composer pinned
   - One consolidated mobile block (max-width:900px)
*/

:root{
  --ink:#fff;
  --ink-dim:#d8d8df;
  --bubble-me:#ff2d83;
  --bubble-them:#1f1f26;
  --glass: rgba(0,0,0,.28);
  --glass-strong: rgba(0,0,0,.45);
  --radius:14px;
}

/* Page scaffold */
html,body{height:100%; margin:0; background:#0a0a0d; color:var(--ink); font-family: system-ui, -apple-system, Segoe UI, Inter, Arial, sans-serif;}
body{display:flex;}

/* ===== WALLPAPER =====
   The background image is applied via inline style on .wall or by JS setting --wall-url on :root.
   Fallback is a dark texture.
*/
.wall{
  position:fixed; inset:0; z-index:0;
  background:
    var(--wall-url, url('/images/bg/default.webp')) center/cover no-repeat fixed;
  /* iOS ignores fixed sometimes; we handle in mobile block */
  filter:saturate(1.02) contrast(1.04);
}
.wall::after{
  /* legibility veil */
  content:""; position:absolute; inset:0;
  background:
    radial-gradient(120% 120% at 20% 10%, transparent 40%, rgba(0,0,0,.55) 85%),
    linear-gradient(0deg, rgba(0,0,0,.35), rgba(0,0,0,.25) 30%, rgba(0,0,0,.45));
}

/* ===== LAYOUT WRAP ===== */
.chat-shell{
  position:relative; z-index:1; /* above wall */
  display:grid; grid-template-columns: 460px 1fr;
  gap:24px; width:100%; max-width:1400px; margin:0 auto; padding:28px;
  box-sizing:border-box;
}

/* ===== LEFT: HERO PORTRAIT ===== */
.hero{
  position:sticky; top:28px;
  align-self:start; width:100%; height:auto;
  border-radius:24px; overflow:hidden;
  box-shadow:0 18px 60px rgba(0,0,0,.45);
}
.hero img{display:block; width:100%; height:auto;}

/* ===== RIGHT: CHAT COLUMN ===== */
.chat-col{
  display:flex; flex-direction:column; min-height:0; /* allow child flex scroll */
}

/* Feed: only thing that scrolls */
#feed{
  flex:1 1 auto; min-height:0; overflow:auto;
  padding:18px; border-radius:18px;
  background: rgba(0,0,0,.22);
  backdrop-filter: blur(4px);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);
}

/* Bubbles */
.msg{max-width:78%; margin:10px 0; padding:12px 14px; border-radius:16px; line-height:1.35;}
.msg.them{background:var(--bubble-them); border-top-left-radius:4px; color:#eef;}
.msg.me{background: linear-gradient(180deg,#ff2d83,#ff165f); border-top-right-radius:4px; margin-left:auto; color:#fff;}

/* System banner line */
.banner{
  margin:0 auto 14px; padding:10px 14px;
  color:#e8ebf5; background:rgba(0,0,0,.35);
  border-radius:999px; font-weight:600; width:max-content;
  backdrop-filter: blur(2px);
}

/* ===== COMPOSER (pinned) ===== */
.composer-wrap{ position:sticky; bottom:0; margin-top:14px; }
.composer{
  display:flex; gap:10px; align-items:center;
  background: rgba(0,0,0,.34); border:1px solid rgba(255,255,255,.12);
  padding:10px; border-radius:16px;
  backdrop-filter: blur(6px);
}
#input{
  flex:1 1 auto; min-width:0; font-size:16px; /* prevent iOS zoom */
  padding:12px 14px; border:0; outline:none; color:#fff;
  background:rgba(255,255,255,.06); border-radius:12px;
}
#sendBtn{
  white-space:nowrap; padding:12px 16px; border:0; cursor:pointer;
  color:#fff; border-radius:12px;
  background: linear-gradient(180deg,#ff2d83,#ff165f);
  box-shadow:0 10px 26px rgba(255,22,95,.28);
}

/* ===== MOBILE (one consolidated block) ===== */
@media (max-width:900px){

  .wall{
    /* drop 'fixed' on iOS to avoid jank; emulate via container scroll */
    background-attachment:scroll;
  }

  .chat-shell{
    grid-template-columns: 1fr;
    gap:14px; padding:14px;
  }

  /* Fixed hero ~38vh at top */
  .hero{
    position:sticky; top:0; height:38vh; border-radius:18px;
  }
  .hero img{
    width:100%; height:100%; object-fit:cover;
  }

  /* Chat column fills below hero; only feed scrolls */
  #feed{
    max-height: calc(100vh - 38vh - 110px); /* 110 = composer + paddings */
    overflow:auto;
    background: rgba(0,0,0,.20);
  }

  .composer-wrap{ position:sticky; bottom:0; }
  #input{ font-size:16px; } /* keep at least 16px to stop iOS zoom */
}
