<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Blossom &amp; Blade</title>

  <!-- Landing-only hammer: nuke any per-man/card backgrounds, even from old CSS -->
  <style>
    /* Stop legacy background images cold */
    .grid .card,
    .grid .card::before,
    .grid .card::after,
    .grid .card .pic,
    .grid .card .pic::before,
    .grid .card .pic::after{
      background:none !important;
      background-image:none !important;
    }
    /* Make sure the face image is visible and covers the frame */
    .card .pic{ position:relative; aspect-ratio:4/5; background:#000 !important; overflow:hidden; }
    .card .pic img{ display:block !important; width:100%; height:100%; object-fit:cover; }
    /* 6-across on large screens; smaller breakpoints stay responsive via home.css */
    @media (min-width:1200px){ .grid{ grid-template-columns:repeat(6,1fr) !important; } }
  </style>

  <!-- Site styles (version bump so phones fetch fresh CSS) -->
  <link rel="stylesheet" href="/styles/home.css?v=20">
</head>
<body>
  <div class="container">
    <header class="site-header">
      <div class="brand">Blossom &amp; Blade</div>
      <div class="header-actions">
        <a class="btn" href="/pay.html">Plans</a>
      </div>
    </header>

    <div class="announce">
      <strong>Today’s promo:</strong> $1 from each purchase supports domestic violence resources.
    </div>

    <main class="grid">
      <!-- Blade -->
      <article class="card" data-man="blade">
        <div class="pic">
          <img alt="Blade" loading="lazy">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=blade">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=blade">Preview</a>
        </div>
      </article>

      <!-- Viper -->
      <article class="card" data-man="viper">
        <div class="pic">
          <img alt="Viper" loading="lazy">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=viper">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=viper">Preview</a>
        </div>
      </article>

      <!-- Dylan -->
      <article class="card" data-man="dylan">
        <div class="pic">
          <img alt="Dylan" loading="lazy">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=dylan">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=dylan">Preview</a>
        </div>
      </article>

      <!-- Alexander -->
      <article class="card" data-man="alexander">
        <div class="pic">
          <img alt="Alexander" loading="lazy">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=alexander">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=alexander">Preview</a>
        </div>
      </article>

      <!-- Grayson -->
      <article class="card" data-man="grayson">
        <div class="pic">
          <img alt="Grayson" loading="lazy">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=grayson">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=grayson">Preview</a>
        </div>
      </article>

      <!-- Silas -->
      <article class="card" data-man="silas">
        <div class="pic">
          <img alt="Silas" loading="lazy">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=silas">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=silas">Preview</a>
        </div>
      </article>
    </main>

    <footer class="footer">
      Need support? 988 Suicide &amp; Crisis Lifeline — call or text 988 (US). If you’re in immediate danger, call 911.
    </footer>
  </div>

  <!-- Bulletproof face loader: tries -card-on.webp, then -card.webp, then .jpg/.png -->
  <script>
    (function(){
      const bust = 'f=8'; // cache-bust so phones drop stale assets
      const exts = ['webp','jpg','png'];           // supported formats to try
      const variants = ['-card-on','-card'];       // prefer "-card-on", fall back to "-card"

      function candidates(man){
        const base = `/images/characters/${man}/${man}`;
        const list = [];
        for (const v of variants){
          for (const ext of exts){
            list.push(`${base}${v}.${ext}?${bust}`);
          }
        }
        return list;
      }

      function loadWithFallback(img, list){
        if (!list.length) return; // give up silently
        const url = list.shift();
        // set next candidate on error, then attempt to load
        img.onerror = () => loadWithFallback(img, list);
        img.src = url;
      }

      // Nuke any per-man class names that might re-apply backgrounds
      document.querySelectorAll('.card').forEach(card => { card.className = 'card'; });

      // For each card, load the first working face image
      document.querySelectorAll('.card[data-man] .pic img').forEach(img => {
        const man = img.closest('.card')?.getAttribute('data-man') || 'blade';
        loadWithFallback(img, candidates(man));
      });
    })();
  </script>
</body>
</html>
