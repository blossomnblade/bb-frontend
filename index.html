<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Blossom &amp; Blade</title>

  <!-- LANDING kill-switch: annihilate any old per-man background styles -->
  <style>
    /* Nuke all background-image sources on landing cards, including pseudo elements */
    .grid .card,
    .grid .card::before,
    .grid .card::after,
    .grid .card .pic,
    .grid .card .pic::before,
    .grid .card .pic::after{
      background: none !important;
      background-image: none !important;
      box-shadow: none; /* just in case someone hid an image in a shadow */
    }
    .card .pic{ position:relative; aspect-ratio:4/5; background:#000 !important; overflow:hidden; }
    .card .pic img{ display:block !important; width:100%; height:100%; object-fit:cover; }

    /* 6-across on large screens; smaller breakpoints handled in home.css */
    @media (min-width:1200px){ .grid{ grid-template-columns:repeat(6,1fr) !important; } }
  </style>

  <!-- Site styles (version bump so phones fetch fresh CSS) -->
  <link rel="stylesheet" href="/styles/home.css?v=21">
</head>
<body class="landing">
  <div class="container">
    <header class="site-header">
      <div class="brand">Blossom &amp; Blade</div>
      <div class="header-actions">
        <a class="btn" href="/pay.html">Plans</a>
      </div>
    </header>

    <div class="announce">
      <strong>Today’s promo:</strong> $1 from each purchase supports domestic violence resources.
    </div>

    <main class="grid">
      <!-- Blade -->
      <article class="card" data-man="blade">
        <div class="pic" style="background:none !important;background-image:none !important;">
          <img alt="Blade" loading="lazy" style="display:block !important;width:100%;height:100%;object-fit:cover;">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=blade">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=blade">Preview</a>
        </div>
      </article>

      <!-- Viper -->
      <article class="card" data-man="viper">
        <div class="pic" style="background:none !important;background-image:none !important;">
          <img alt="Viper" loading="lazy" style="display:block !important;width:100%;height:100%;object-fit:cover;">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=viper">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=viper">Preview</a>
        </div>
      </article>

      <!-- Dylan -->
      <article class="card" data-man="dylan">
        <div class="pic" style="background:none !important;background-image:none !important;">
          <img alt="Dylan" loading="lazy" style="display:block !important;width:100%;height:100%;object-fit:cover;">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=dylan">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=dylan">Preview</a>
        </div>
      </article>

      <!-- Alexander -->
      <article class="card" data-man="alexander">
        <div class="pic" style="background:none !important;background-image:none !important;">
          <img alt="Alexander" loading="lazy" style="display:block !important;width:100%;height:100%;object-fit:cover;">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=alexander">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=alexander">Preview</a>
        </div>
      </article>

      <!-- Grayson -->
      <article class="card" data-man="grayson">
        <div class="pic" style="background:none !important;background-image:none !important;">
          <img alt="Grayson" loading="lazy" style="display:block !important;width:100%;height:100%;object-fit:cover;">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=grayson">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=grayson">Preview</a>
        </div>
      </article>

      <!-- Silas -->
      <article class="card" data-man="silas">
        <div class="pic" style="background:none !important;background-image:none !important;">
          <img alt="Silas" loading="lazy" style="display:block !important;width:100%;height:100%;object-fit:cover;">
        </div>
        <div class="body">
          <a class="btn" href="/age.html?next=/chat.html?man=silas">Chat now</a>
          <a class="btn-ghost" href="/chat.html?man=silas">Preview</a>
        </div>
      </article>
    </main>

    <footer class="footer">
      Need support? 988 Suicide &amp; Crisis Lifeline — call or text 988 (US). If you’re in immediate danger, call 911.
    </footer>
  </div>

  <!-- Bulletproof face loader + background scrubbing -->
  <script>
    (function(){
      // 0) Scrub any stray per-man markers that could leak backgrounds
      document.body.removeAttribute('data-man');
      (document.body.className || '').split(/\s+/).forEach(c=>{
        if (['blade','viper','dylan','alexander','grayson','silas'].includes(c)) {
          document.body.classList.remove(c);
        }
      });

      const bust = 'f=21'; // bump this next time you change a face image
      const exts = ['webp','jpg','png'];       // formats to try
      const variants = ['-card-on','-card'];   // prefer -card-on, fall back to -card

      function candidates(man){
        const base = `/images/characters/${man}/${man}`;
        const list = [];
        for (const v of variants){
          for (const ext of exts){
            list.push(`${base}${v}.${ext}?${bust}`);
          }
        }
        return list;
      }

      function loadWithFallback(img, list){
        if (!list.length) return;
        const url = list.shift();
        img.onerror = ()=> loadWithFallback(img, list);
        img.src = url;
      }

      // 1) Strip ANY background imagery on every card.pic at runtime (ultimate override)
      document.querySelectorAll('.card .pic').forEach(pic=>{
        pic.style.setProperty('background','none','important');
        pic.style.setProperty('background-image','none','important');
        // kill pseudo via CSS injection per element (belt + suspenders)
        const killer = document.createElement('style');
        killer.textContent = `
          .card .pic::before, .card .pic::after{ content:none !important; background:none !important; }
        `;
        pic.appendChild(killer);
      });

      // 2) Load the first working face image for each man
      document.querySelectorAll('.card[data-man] .pic img').forEach(img=>{
        const man = img.closest('.card')?.getAttribute('data-man') || 'blade';
        loadWithFallback(img, candidates(man));
      });
    })();
  </script>
</body>
</html>
